<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="/DreamGate/css/css.css">
    <style type="text/css">
        #steal,
        #steal table {
            font-size: 12pt;
            table-layout: fixed;
        }

        #steal td {
            padding: 1px;
            color: #FF0000;
            cursor: pointer;
        }

        #steal td:hover {
            background-color: #d8cca8
        }

        table.style th,
        table.style td {
            padding: 1px;
        }
    </style>
    <script type="text/javascript" src="/DreamGate/js/jquery-3.6.3.min.js"></script>
    <script type="text/javascript" src="/DreamGate/js/function.js"></script>
    <script type="text/javascript">

        $(function () {
            initGrid();
        });

        var keys = new Array();
        var condition = {};

        function selType(type){
            condition.type = type;
        }
        function selLv(lv){
            condition.lv = lv;
        }


        function sel(cell) {
            var key = $(cell).text();
            var hasKey = false;
            if (keys) {
                for (var i = 0; i < keys.length; i++) {
                    if (key == keys[i]) {
                        hasKey = true;
                        break;
                    }
                }
            }

            if (hasKey) {
                $(cell).removeClass("head");
                keys.pop(key);
            } else {
                $(cell).addClass("head");
                keys.push(key);
            }

            keys.sort();
            $("#keys").html(keys.join(','));
            initGrid();
        }

        function init() {
            keys.length = 0;
            $(".body").removeClass('head');
            $("#keys").html(keys.join(','));
            initGrid();
        }

        function initGrid() {
            $("#item_list").empty();
            var num = 0;
            var rows = new Array();
            $.getJSON(DATA.EQUIP, function (data) {
                $(data).each(function (i, s) {
                    var include = true;
                    // var include = keys.length == 0;
                    // //filter
                    // if(!include){
                    //     $(keys).each(function(j, key){
                    //         if(isNaN(key)){
                    //             if(s.func.includes(key)){
                    //                 include = true;
                    //                 return false;
                    //             }
                    //         } else {
                    //             if(s.lv == key){
                    //                 include = true;
                    //                 return false;
                    //             }
                    //         }
                    //     });
                    // }

                    //fillGrid
                    if (include) {
                        num++;

                        rows.push('<tr><td rowspan="3" style="width:10%">');
                        rows.push(s.lv);
                        rows.push('</td><td style="width:10%"><img src="/DreamGate/image/item/');
                        rows.push(s.name);
                        rows.push('.png"/></td><td style="width:10%">');
                        if (s.items[0]) {
                            rows.push('<img src="/DreamGate/image/item/');
                            rows.push(s.items[0].name);
                            rows.push('.png"/>');
                        }
                        rows.push('</td><td style="width:10%">');
                        if (s.items[1]) {
                            rows.push('<img src="/DreamGate/image/item/');
                            rows.push(s.items[1].name);
                            rows.push('.png"/>');
                        }
                        rows.push('</td><td style="width:10%">');
                        if (s.items[2]) {
                            rows.push('<img src="/DreamGate/image/item/');
                            rows.push(s.items[2].name);
                            rows.push('.png"/>');
                        }
                        rows.push('</td><td style="width:10%">');
                        if (s.items[3]) {
                            rows.push('<img src="/DreamGate/image/item/');
                            rows.push(s.items[3].name);
                            rows.push('.png"/>');
                        }
                        rows.push('</td><td style="width:10%">');
                        if (s.items[4]) {
                            rows.push('<img src="/DreamGate/image/item/');
                            rows.push(s.items[4].name);
                            rows.push('.png"/>');
                        }
                        rows.push('</td><td style="width:30%" rowspan="3">');
                        rows.push(s.func);
                        rows.push('</td></tr>');

                        rows.push('<tr><td>');
                        rows.push(s.name);
                        rows.push('</td><td>');
                        if (s.items[0]) {
                            rows.push(s.items[0].name);
                        }
                        rows.push('</td><td>');
                        if (s.items[1]) {
                            rows.push(s.items[1].name);
                        }
                        rows.push('</td><td>');
                        if (s.items[2]) {
                            rows.push(s.items[2].name);
                        }
                        rows.push('</td><td>');
                        if (s.items[3]) {
                            rows.push(s.items[3].name);
                        }
                        rows.push('</td><td>');
                        if (s.items[4]) {
                            rows.push(s.items[4].name);
                        }
                        rows.push('</td></tr>');

                        rows.push('<tr><td>');
                        rows.push(s.type);
                        rows.push('</td><td>');
                        if (s.items[0]) {
                            rows.push(s.items[0].count);
                        }
                        rows.push('</td><td>');
                        if (s.items[1]) {
                            rows.push(s.items[1].count);
                        }
                        rows.push('</td><td>');
                        if (s.items[2]) {
                            rows.push(s.items[2].count);
                        }
                        rows.push('</td><td>');
                        if (s.items[3]) {
                            rows.push(s.items[3].count);
                        }
                        rows.push('</td><td>');
                        if (s.items[4]) {
                            rows.push(s.items[4].count);
                        }
                        rows.push('</td></tr>');
                    }
                });
                $("#item_list").html(rows.join(''));
                $("#keys").html($("#keys").html() + "   符合条件:" + num);
            });

        }
    </script>
</head>

<body>
    <div class="head">生产制作</div>
    <table id="steal" class="style">
        <tbody>
            <tr>
                <td onclick="selType(this)" style="color: #5A02FF">剑</td>
                <td onclick="selType(this)" style="color: #5A02FF">斧</td>
                <td onclick="selType(this)" style="color: #5A02FF">枪</td>
                <td onclick="selType(this)" style="color: #EE0000">弓</td>
                <td onclick="selType(this)" style="color: #EE0000">拳</td>
                <td onclick="selType(this)" style="color: #EE0000">刀</td>
                <td onclick="selType(this)" style="color: #EE0000">投</td>
                <td onclick="selType(this)" style="color: #00FF00">杖</td>
                <td onclick="selKeys(this)" style="color: #4E92C2">血瓶</td>
            </tr>
            <tr>
                <td onclick="selType(this)" style="color: #5A02FF">铠</td>
                <td onclick="selType(this)" style="color: #5A02FF">盔</td>
                <td onclick="selType(this)" style="color: #5A02FF">靴</td>
                <td onclick="selType(this)" style="color: #5A02FF">盾</td>
                <td onclick="selType(this)" style="color: #EE0000">衣</td>
                <td onclick="selType(this)" style="color: #EE0000">帽</td>
                <td onclick="selType(this)" style="color: #EE0000">鞋</td>
                <td onclick="selType(this)" style="color: #00FF00">袍</td>
                <td onclick="selKeys(this)" style="color: #4E92C2">料理</td>
            </tr>
            <tr>
                <td onclick="selLevel(1)">Lv.1</td>
                <td onclick="selLevel(2)">Lv.2</td>
                <td onclick="selLevel(3)">Lv.3</td>
                <td onclick="selLevel(4)">Lv.4</td>
                <td onclick="selLevel(5)">Lv.5</td>
                <td disabled="disabled" rowspan="2">5C</td>
                <td onclick="selKeys(this)" rowspan="2">7C</td>
                <td onclick="selKeys(this)" rowspan="2">8C</td>
                <td onclick="selKeys(this)" rowspan="2">9C</td>
            </tr>
            <tr>
                <td onclick="selLevel(6)">Lv.6</td>
                <td onclick="selLevel(7)">Lv.7</td>
                <td onclick="selLevel(8)">Lv.8</td>
                <td onclick="selLevel(9)">Lv.9</td>
                <td onclick="selLevel(10)">Lv.10</td>
            </tr>

            <tr>
                <td onclick="selKeys(this)">生命</td>
                <td onclick="selKeys(this)">魔力</td>
                <td onclick="selKeys(this)">必杀</td>
                <td onclick="selKeys(this)">命中</td>
                <td onclick="selKeys(this)">反击</td>
                <td onclick="selKeys(this)">闪躲</td>
                <td rowspan="3" colspan="3" onclick="init()" style="color:0">清空条件</td>
            </tr>
            <tr>
                <td onclick="selKeys(this)">攻击</td>
                <td onclick="selKeys(this)">防御</td>
                <td onclick="selKeys(this)">敏捷</td>
                <td onclick="selKeys(this)">精神</td>
                <td onclick="selKeys(this)">回复</td>
                <td onclick="selKeys(this)">魅力</td>
            </tr>
            <tr>
                <td onclick="selKeys(this)">抗毒</td>
                <td onclick="selKeys(this)">抗昏睡</td>
                <td onclick="selKeys(this)">抗石化</td>
                <td onclick="selKeys(this)">抗酒醉</td>
                <td onclick="selKeys(this)">抗混乱</td>
                <td onclick="selKeys(this)">抗遗忘</td>
            </tr>
        </tbody>
    </table>
    <hr>

    <div id="itemlist_div" style="text-align: center; color: #ff0000">
        <b id="keys" style="font-size: 12pt;"></b><br>
        <table class="style" style="width: 100%;height: 100px">
            <thead>
                <tr class="head">
                    <td width="10%">等级</td>
                    <td width="10%">名称</td>
                    <td width="50%" colspan="5">配方图</td>
                    <td width="30%">能力</td>
                </tr>
            </thead>
            <tbody id="item_list">

            </tbody>
        </table>
        <p onclick="window.document.body.scrollTop=0" style="cursor:hand"><b>回頂部</b></p>
    </div>

</body>

</html>